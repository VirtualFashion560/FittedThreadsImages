<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fitted Threads - Virtual Try-On</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<style>
 body { margin:0; background:linear-gradient(135deg,#d9b382,#a46237); color:#4b3221; font-family:'Poppins',sans-serif; text-align:center; padding:20px; min-height:100vh; }
 h1 { font-family:'Pacifico',cursive; font-size:3rem; color:#6e4b26; margin-bottom:0.3em; }
 .slogan { font-style:italic; font-weight:600; color:#7a5a34; font-size:1.4rem; margin-bottom:1em; }
 .preview-container { display:flex; justify-content:center; gap:20px; margin:1em 0; flex-wrap:wrap; }
 .preview-container img, .preview-container video { max-width:300px; max-height:400px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.3); }
 .section { background: rgba(217,179,130,0.85); padding:1.5em 2em; border-radius:12px; max-width:700px; margin:2em auto; color:#4b3221; text-align:center; box-shadow:0 0 10px rgba(141,102,58,0.3); }
 .loading { font-weight:bold; color:#6e4b26; margin-top:1em; }
 .btn { padding:10px 20px; font-size:1rem; font-weight:600; border:none; border-radius:8px; cursor:pointer; background-color:#6e4b26; color:#fff; transition:0.3s; margin-top:1em; }
 .btn:hover { background-color:#7a5a34; }
</style>
</head>
<body>

<h1>Fitted Threads</h1>
<p class="slogan">See Your Look in Action</p>

<div class="preview-container" id="uploads">
 <img id="selfImage" src="" alt="Your Photo"/>
 <img id="clothImage" src="" alt="Clothing"/>
</div>

<div class="section">
 <h2>AI Generated Image</h2>
 <div id="aiImageContainer">
 <p class="loading" id="imageLoading">Generating AI try-on image...</p>
 <img id="aiImage" src="" alt="AI Try-On" style="display:none"/>
 </div>
</div>

<div class="section">
 <h2>AI Generated Video</h2>
 <div id="aiVideoContainer">
 <p class="loading" id="videoLoading">Generating AI try-on video...</p>
 <video id="aiVideo" controls autoplay loop style="display:none"></video>
 </div>
</div>

<script>
async function loadImages() {
 const selfData = localStorage.getItem('selfImage');
 const clothData = localStorage.getItem('clothImage');

 if(selfData && clothData){
 document.getElementById('selfImage').src = selfData;
 document.getElementById('clothImage').src = clothData;
 generateAI(selfData, clothData);
 } else {
 alert('Missing images. Please upload on the main page.');
 window.location.href = 'index.html';
 }
}

// Backend API call to generate AI try-on image
async function generateAI(selfImg, clothImg) {
 const imageLoading = document.getElementById('imageLoading');
 const aiImage = document.getElementById('aiImage');
 const videoLoading = document.getElementById('videoLoading');
 const aiVideo = document.getElementById('aiVideo');

 try {
 // Send images to backend
 const response = await fetch('/api/generate-tryon', {
 method:'POST',
 headers:{'Content-Type':'application/json'},
 body: JSON.stringify({self: selfImg, clothing: clothImg})
 });
 const data = await response.json();

 // AI Generated Image
 if(data.aiImage){
 aiImage.src = data.aiImage;
 aiImage.style.display = 'block';
 imageLoading.style.display = 'none';
 }

 // AI Generated Video
 if(data.aiVideo){
 aiVideo.src = data.aiVideo;
 aiVideo.style.display = 'block';
 videoLoading.style.display = 'none';
 }

 } catch(err){
 console.error(err);
 imageLoading.innerText = 'Failed to generate AI image.';
 videoLoading.innerText = 'Failed to generate AI video.';
 }
}

loadImages();
</script>

</body>
</html>
