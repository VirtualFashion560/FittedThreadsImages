<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitted Threads - Try-On</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<style>
body { margin:0; font-family:'Poppins',sans-serif; background:linear-gradient(135deg,#a46237,#d9b382); color:#4b3221; text-align:center; padding:20px; }
h1 { font-family:'Pacifico',cursive; font-size:3rem; color:#6e4b26; margin-bottom:0.5em; }
.section { margin:2em 0; }
.images, .results { display:flex; justify-content:center; gap:20px; flex-wrap:wrap; margin-top:1em; }
.images img, .results img { max-width:250px; border-radius:12px; }
video { max-width:400px; border-radius:12px; margin-top:10px; }
.btn { padding:10px 25px; font-size:1.1rem; font-weight:600; border:none; border-radius:8px; cursor:pointer; background-color:#6e4b26; color:#fff; transition:0.3s; margin-top:1em; }
.btn:hover { background-color:#7a5a34; }
</style>
</head>
<body>

<h1>Fitted Threads - AI Try-On</h1>

<div class="section">
<h2>Uploaded Images</h2>
<div class="images">
<img id="selfImage" src="" alt="Your Photo">
<img id="clothImage" src="" alt="Clothing Photo">
</div>
</div>

<div class="section">
<h2>AI Generated Results</h2>
<button class="btn" id="generateBtn">Generate AI Try-On</button>
<div class="results">
<img id="aiImage" src="" alt="AI Generated Image" style="display:none;">
<video id="aiVideo" controls autoplay loop style="display:none;"></video>
</div>
</div>

<script>
const selfImg = document.getElementById('selfImage');
const clothImg = document.getElementById('clothImage');
const aiImage = document.getElementById('aiImage');
const aiVideo = document.getElementById('aiVideo');
const generateBtn = document.getElementById('generateBtn');

// Load images from localStorage
window.addEventListener('load', () => {
const selfData = localStorage.getItem('selfImage');
const clothData = localStorage.getItem('clothImage');
if(selfData && clothData){
selfImg.src = selfData;
clothImg.src = clothData;
} else {
alert('No uploaded images found. Redirecting to home.');
window.location.href = 'index.html';
}
});

// AI generation button
generateBtn.addEventListener('click', async () => {
generateBtn.disabled = true;
generateBtn.textContent = 'Generating...';

try {
const selfData = localStorage.getItem('selfImage');
const clothData = localStorage.getItem('clothImage');

// Send images to backend API (replace with your actual endpoint)
const response = await fetch('/api/generate-tryon', {
method:'POST',
headers:{ 'Content-Type':'application/json' },
body: JSON.stringify({ self: selfData, cloth: clothData })
});

const result = await response.json();
// Expect result { image: 'data:image/png;base64,...', video: 'data:video/mp4;base64,...' }
if(result.image){
aiImage.src = result.image;
aiImage.style.display = 'block';
}
if(result.video){
aiVideo.src = result.video;
aiVideo.style.display = 'block';
}

} catch(err){
alert('Error generating AI try-on: '+err);
}

generateBtn.disabled = false;
generateBtn.textContent = 'Generate AI Try-On';
});
</script>

</body>
</html>
